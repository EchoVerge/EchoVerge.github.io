<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÊàëÁöÑÂÄã‰∫∫Ë≤°ÂãôÁÆ°ÁêÜ (FirebaseÁâà)</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
    
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="bg-light">

    <div id="loader"></div>

    <div class="container my-4" id="app-container" style="display: none;">
        
        <h2 class="mb-4 fw-bold">üí∞ Ë≤°ÂãôÂÑÄË°®Êùø <small class="text-muted fs-6">(v1.0 Local)</small></h2>

        <ul class="nav nav-tabs mb-4" id="mainTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link active" id="dashboard-tab-btn" data-bs-toggle="tab" data-bs-target="#dashboard-tab" type="button" role="tab">
                    <i class="bi bi-grid-1x2-fill"></i> ÂÑÄË°®Êùø
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="portfolio-tab-btn" data-bs-toggle="tab" data-bs-target="#portfolio-tab" type="button" role="tab">
                    <i class="bi bi-graph-up-arrow"></i> ÊäïË≥áÁµÑÂêà
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" id="settings-tab-btn" data-bs-toggle="tab" data-bs-target="#settings-tab" type="button" role="tab">
                    <i class="bi bi-gear-fill"></i> Á≥ªÁµ±Ë®≠ÂÆö
                </button>
            </li>
        </ul>

        <div class="tab-content" id="mainTabsContent">

            <div class="tab-pane fade show active" id="dashboard-tab" role="tabpanel">
                <div class="row g-4">
                    
                    <div class="col-lg-5 d-flex flex-column gap-4">
                        
                        <div class="dashboard-module mb-0">
                            <h4 class="module-title"><i class="bi bi-wallet2"></i> Ë≥áÁî¢Á∏ΩË¶Ω</h4>
                            <div class="text-center py-3">
                                <div class="text-muted small">ÁõÆÂâçÁèæÈáëÁ∏ΩË≥áÁî¢</div>
                                <h2 class="fw-bold mb-0" id="total-assets-display">$ 0</h2>
                            </div>
                            <hr>
                            <ul class="list-group list-group-flush small" id="account-balance-list">
                                <li class="list-group-item text-muted text-center">Ë®àÁÆó‰∏≠...</li>
                            </ul>
                        </div>

                        <div class="dashboard-module mb-0 flex-grow-1">
                            <h4 class="module-title"><i class="bi bi-pie-chart-fill"></i> ÊîØÂá∫È°ûÂà•‰ΩîÊØî</h4>
                            <div style="height: 250px; position: relative;">
                                <canvas id="categoryPieChart"></canvas>
                            </div>
                            <p id="pie-chart-no-data" class="text-center text-muted small mt-3 d-none">ÁÑ°ÊîØÂá∫Ë≥áÊñô</p>
                        </div>

                    </div>

                    <div class="col-lg-7 d-flex flex-column gap-4">
                        
                        <div class="row g-3">
                            <div class="col-6">
                                <div class="stat-card">
                                    <div class="stat-label">ÊúüÈñìÁ∏ΩÊî∂ÂÖ•</div>
                                    <div class="stat-value text-income" id="stat-income">$ 0</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="stat-card">
                                    <div class="stat-label">ÊúüÈñìÁ∏ΩÊîØÂá∫</div>
                                    <div class="stat-value text-expense" id="stat-expense">$ 0</div>
                                </div>
                            </div>
                        </div>

                        <div class="dashboard-module mb-0">
                            <h4 class="module-title"><i class="bi bi-bar-chart-line-fill"></i> Êî∂ÊîØË∂®Âã¢ (ÊúÄËøë 30 Á≠Ü)</h4>
                            <div style="height: 250px; position: relative;">
                                <canvas id="trendChart"></canvas>
                            </div>
                        </div>

                        <div class="dashboard-module mb-0 flex-grow-1">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h4 class="module-title mb-0"><i class="bi bi-list-ul"></i> ËøëÊúü‰∫§Êòì</h4>
                                <div>
                                    <button class="btn btn-sm btn-primary me-1" onclick="document.getElementById('add-date').valueAsDate=new Date();" data-bs-toggle="collapse" data-bs-target="#collapseAddForm">
                                        <i class="bi bi-plus-lg"></i> Ë®òÂ∏≥
                                    </button>
                                </div>
                            </div>

                            <div class="collapse mb-3" id="collapseAddForm">
                                <div class="card card-body bg-light border-0">
                                    <h6 class="mb-3">Âø´ÈÄüË®òÂ∏≥</h6>
                                    <form id="addTransactionForm">
                                        <div class="row g-2">
                                            <div class="col-6"><input type="date" class="form-control form-control-sm" id="add-date" required></div>
                                            <div class="col-6">
                                                <select id="add-type" class="form-select form-select-sm" required>
                                                    <option value="" disabled selected>È°ûÂûã</option>
                                                    <option value="ÊîØÂá∫">ÊîØÂá∫</option>
                                                    <option value="Êî∂ÂÖ•">Êî∂ÂÖ•</option>
                                                </select>
                                            </div>
                                            <div class="col-6">
                                                <select id="add-category" class="form-select form-select-sm" disabled required>
                                                    <option value="">È°ûÂà•</option>
                                                </select>
                                            </div>
                                            <div class="col-6">
                                                <select id="add-account" class="form-select form-select-sm" required><option value="">Â∏≥Êà∂</option></select>
                                            </div>
                                            <div class="col-8"><input type="text" class="form-control form-control-sm" id="add-item" placeholder="È†ÖÁõÆ" required></div>
                                            <div class="col-4"><input type="number" class="form-control form-control-sm" id="add-amount" placeholder="$" step="any" required></div>
                                            <div class="col-12"><input type="text" class="form-control form-control-sm" id="add-tags" placeholder="Ê®ôÁ±§ (ÈÅ∏Â°´)"></div>
                                            <div class="col-12"><textarea class="form-control form-control-sm" id="add-notes" rows="1" placeholder="ÂÇôË®ª"></textarea></div>
                                            <div class="col-12"><button type="submit" class="btn btn-primary btn-sm w-100">Êñ∞Â¢û</button></div>
                                        </div>
                                    </form>
                                </div>
                            </div>
                            
                            <div id="transactionsList" class="list-group list-group-flush" style="max-height: 400px; overflow-y: auto;">
                                <div class="text-center text-muted py-4">ËºâÂÖ•‰∏≠...</div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <div class="tab-pane fade" id="portfolio-tab" role="tabpanel">
                <div class="dashboard-module">
                    <h4 class="module-title">ÊäïË≥áÁµÑÂêà</h4>
                    <p class="text-muted">ÂäüËÉΩÈñãÁôº‰∏≠...</p>
                </div>
            </div>

            <div class="tab-pane fade" id="settings-tab" role="tabpanel">
                
                <div class="dashboard-module mb-4 border-start border-4 border-warning">
                    <h5 class="module-title"><i class="bi bi-database-fill-gear"></i> Ë≥áÊñôÂ∫´ÂàùÂßãÂåñ</h5>
                    <p class="text-muted small">Â¶ÇÊûúÊÇ®ÊòØÁ¨¨‰∏ÄÊ¨°‰ΩøÁî®ÔºåË´ãÈªûÊìä‰∏ãÊñπÊåâÈàï‰æÜÂØ´ÂÖ•È†êË®≠ÁöÑÈ°ûÂà•ËàáÂ∏≥Êà∂„ÄÇ</p>
                    <button id="btn-init-data" class="btn btn-warning btn-sm">
                        <i class="bi bi-magic"></i> ÂØ´ÂÖ•È†êË®≠Ë≥áÊñô
                    </button>
                </div>

                <div class="settings-grid">
                    
                    <div class="dashboard-module">
                        <h4 class="module-title"><i class="bi bi-tags-fill"></i> È°ûÂà•ÁÆ°ÁêÜ</h4>
                        <form id="addCategoryForm" class="row g-2 align-items-end mb-3">
                            <div class="col-5">
                                <label class="form-label small">ÂêçÁ®±</label>
                                <input type="text" class="form-control form-control-sm" id="new-category-name" required>
                            </div>
                            <div class="col-4">
                                <label class="form-label small">È°ûÂûã</label>
                                <select id="new-category-type" class="form-select form-select-sm" required>
                                    <option value="ÊîØÂá∫">ÊîØÂá∫</option>
                                    <option value="Êî∂ÂÖ•">Êî∂ÂÖ•</option>
                                </select>
                            </div>
                            <div class="col-3">
                                <button type="submit" class="btn btn-success btn-sm w-100"><i class="bi bi-plus-lg"></i></button>
                            </div>
                        </form>
                        <hr>
                        <ul class="list-group list-group-flush" id="settings-category-list">
                            <li class="list-group-item text-muted small">ËºâÂÖ•‰∏≠...</li>
                        </ul>
                    </div>
                    
                    <div class="dashboard-module">
                        <h4 class="module-title"><i class="bi bi-wallet2"></i> Â∏≥Êà∂ÁÆ°ÁêÜ</h4>
                        <form id="addAccountForm" class="row g-2 align-items-end mb-3">
                            <div class="col-7">
                                <label class="form-label small">Â∏≥Êà∂ÂêçÁ®±</label>
                                <input type="text" class="form-control form-control-sm" id="new-account-name" required>
                            </div>
                            <div class="col-5">
                                <label class="form-label small">ÂàùÂßãÈáëÈ°ç</label>
                                <input type="number" step="any" class="form-control form-control-sm" id="new-account-initial" value="0" required>
                            </div>
                            <div class="col-12 mt-2">
                                <button type="submit" class="btn btn-success btn-sm w-100"><i class="bi bi-plus-lg"></i> Êñ∞Â¢ûÂ∏≥Êà∂</button>
                            </div>
                        </form>
                        <hr>
                        <ul class="list-group list-group-flush" id="settings-account-list">
                            <li class="list-group-item text-muted small">ËºâÂÖ•‰∏≠...</li>
                        </ul>
                    </div>

                    <div class="dashboard-module">
                        <h4 class="module-title"><i class="bi bi-bookmark-plus-fill"></i> Ê®ôÁ±§ÁÆ°ÁêÜ</h4>
                        <form id="addTagForm" class="row g-2 align-items-end mb-3">
                            <div class="col-8">
                                <label class="form-label small">Ê®ôÁ±§ÂêçÁ®±</label>
                                <input type="text" class="form-control form-control-sm" id="new-tag-name" placeholder="#ÂêçÁ®±" required>
                            </div>
                            <div class="col-4">
                                <button type="submit" class="btn btn-success btn-sm w-100"><i class="bi bi-plus-lg"></i></button>
                            </div>
                        </form>
                        <hr>
                        <ul class="list-group list-group-flush" id="settings-tag-list">
                            <li class="list-group-item text-muted small">ËºâÂÖ•‰∏≠...</li>
                        </ul>
                    </div>

                </div>
            </div>

        </div>
    </div>

    <div class="modal fade" id="editTransactionModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Á∑®ËºØ‰∫§Êòì</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="editTransactionForm">
                        <input type="hidden" id="edit-id"> <div class="row g-3">
                            <div class="col-6">
                                <label for="edit-date" class="form-label small">Êó•Êúü</label>
                                <input type="date" class="form-control" id="edit-date" required>
                            </div>
                            <div class="col-6">
                                <label for="edit-type" class="form-label small">È°ûÂûã</label>
                                <select id="edit-type" class="form-select" required>
                                    <option value="ÊîØÂá∫">ÊîØÂá∫</option>
                                    <option value="Êî∂ÂÖ•">Êî∂ÂÖ•</option>
                                </select>
                            </div>
                            <div class="col-6">
                                <label for="edit-category" class="form-label small">È°ûÂà•</label>
                                <select id="edit-category" class="form-select" required>
                                    </select>
                            </div>
                            <div class="col-6">
                                <label for="edit-account" class="form-label small">Â∏≥Êà∂</label>
                                <select id="edit-account" class="form-select" required>
                                    </select>
                            </div>
                            <div class="col-6">
                                <label for="edit-item" class="form-label small">È†ÖÁõÆ</label>
                                <input type="text" class="form-control" id="edit-item" required>
                            </div>
                            <div class="col-6">
                                <label for="edit-amount" class="form-label small">ÈáëÈ°ç</label>
                                <input type="number" class="form-control" id="edit-amount" min="0" step="any" required>
                            </div>
                            <div class="col-12">
                                <label for="edit-tags" class="form-label small">Ê®ôÁ±§ (Áî®ÈÄóËôüÂàÜÈöî)</label>
                                <input type="text" class="form-control" id="edit-tags">
                            </div>
                            <div class="col-12">
                                <label for="edit-notes" class="form-label small">ÂÇôË®ª</label>
                                <textarea class="form-control" id="edit-notes" rows="2"></textarea>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÂèñÊ∂à</button>
                    <button type="button" class="btn btn-primary" onclick="document.getElementById('editTransactionForm').dispatchEvent(new Event('submit'))">ÂÑ≤Â≠òËÆäÊõ¥</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    
    <script type="module" src="js/app.js"></script>
</body>
</html>