/* =========================================
   新增：試卷輸出美化樣式 (由程式夥伴提供)
   ========================================= */

/* 1. 試卷整體容器設定 */
.student-section {
    font-family: "Times New Roman", "PMingLiU", serif; /* 使用適合閱讀的襯線字體 */
    padding: 20px;
    box-sizing: border-box;
    background: white; /* 確保背景純白 */
}

/* 2. 表格專屬樣式 */
.student-section table {
    width: 100%;
    border-collapse: collapse; /* 關鍵：合併邊框，讓線條變細且連接 */
    margin-top: 15px;
    font-size: 11pt; /* 適當的字體大小 */
}

/* 儲存格 (標頭 th 與內容 td) 共用設定 */
.student-section th, 
.student-section td {
    border: 1px solid #000; /* 黑色實線邊框 */
    padding: 8px 10px;      /* 內距：上下 8px，左右 10px */
    line-height: 1.5;       /* 行高舒適度 */
    vertical-align: top;    /* 內容靠上對齊 */
    text-align: justify;    /* 文字左右對齊，閱讀較整齊 */
}

/* 表頭專屬設定 */
.student-section th {
    background-color: #f2f2f2; /* 淺灰色背景 */
    color: #000;
    font-weight: bold;
    text-align: center;     /* 標題置中 */
    white-space: nowrap;    /* 標題不換行 */
}

/* 3. 試卷標題區美化 */
.worksheet-header {
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid #000; /* 標題區下方加一條粗線 */
    text-align: center;
}

.worksheet-header h2 {
    margin: 0 0 10px 0;
    font-size: 24px;
    letter-spacing: 2px;
}

.worksheet-info {
    display: flex;
    justify-content: space-between; /* 姓名靠左，日期靠右 */
    font-size: 14px;
    font-weight: bold;
}

/* 4. 教師解答卷特別樣式 (讓解析那一欄稍微小一點字，避免太佔版面) */
.student-section td:nth-child(3) {
    font-size: 0.95em; 
}

/* =========================================
   列印專用設定 (Print Media Query)
   ========================================= */
@media print {
    /* 強制列印背景色 (Chrome/Edge 需要此設定才能印出灰底) */
    .student-section th {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
        background-color: #f2f2f2 !important; 
    }

    /* 確保線條在列印時也是黑色的 */
    .student-section th, 
    .student-section td {
        border: 1px solid #000 !important;
    }
    
    /* 移除網頁上的陰影效果，讓紙張看起來乾淨 */
    .student-section {
        box-shadow: none !important;
        margin: 0;
        padding: 0;
    }
}

/* =========================================
   雙面列印分頁控制
   ========================================= */

/* 1. 確保每個學生的試卷結束後，強制換頁 (讓下一位學生從新的一張紙開始) */
.page-break-active {
    page-break-after: always; /* 舊版瀏覽器支援 */
    break-after: page;        /* 標準語法 */
    display: block;           /* 確保是區塊元素 */
}

/* 2. 補白區塊樣式 (用於將奇數頁補成偶數頁) */
.page-filler {
    display: block;
    page-break-before: always; /* 強制在自己之前換頁 */
    break-before: page;
    height: 1px;               /* 佔用極小高度，避免產生額外空白頁 */
    visibility: hidden;        /* 內容隱藏 */
}

/* 3. 在網頁預覽時顯示分頁線 (方便老師檢查) */
@media screen {
    .page-break-active {
        border-bottom: 5px dashed #ccc; /* 顯示虛線代表分頁 */
        margin-bottom: 40px;            /* 拉開間距 */
        position: relative;
    }
    
    /* 選擇性：加上文字提示 */
    .page-break-active::after {
        content: "--- 這裡是分頁線 (列印時會強制換頁) ---";
        display: block;
        text-align: center;
        color: #999;
        font-size: 12px;
        margin-top: 10px;
    }

    /* 讓補白區塊在螢幕上也稍微可見，或是顯示提示 */
    .page-filler {
        visibility: visible;
        background: repeating-linear-gradient(
            45deg,
            #f3f3f3,
            #f3f3f3 10px,
            #ffffff 10px,
            #ffffff 20px
        );
        height: 50px; /* 螢幕上顯示高度，讓老師知道這裡補了一頁 */
        border: 1px dotted #ddd;
        display: flex;
        align-items: center;
        justify-content: center;
        color: #aaa;
        font-size: 12px;
    }
    .page-filler::before {
        content: "[系統自動補白頁 - 確保雙面列印不跑版]";
    }
}

/* 4. 列印時隱藏多餘提示 */
@media print {
    .page-break-active {
        border-bottom: none !important;
        margin-bottom: 0 !important;
    }
    .page-break-active::after {
        display: none !important;
    }
    .page-filler {
        visibility: hidden !important; /* 列印時隱藏內容 */
        background: none !important;
        border: none !important;
        height: 1px !important; /* 恢復極小高度 */
    }
    .page-filler::before {
        display: none !important;
    }
}