/* assets/css/style.css */

/* 全域設定 */
body { font-family: "Microsoft JhengHei", "Heiti TC", sans-serif; margin: 0; padding: 20px; background: #f5f5f5; color: #333; }

/* 控制面板 */
.control-panel { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin: 0 auto 30px auto; max-width: 900px; }
.panel-row { display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 15px; }
.input-group { flex: 1; min-width: 250px; background: #f9f9f9; padding: 15px; border-radius: 8px; border: 1px solid #eee; transition: background 0.3s; }
.input-group label { display: block; font-weight: bold; margin-bottom: 8px; color: #555; }
.input-group input[type="text"], .input-group input[type="file"] { width: 95%; padding: 5px; }
.options-group { background: #e8f5e9; border-color: #c8e6c9; }

/* 拖放效果 */
.drop-zone.dragover { background-color: #e3f2fd; border: 2px dashed #2196F3; }

/* Checkbox 列表 */
.checkbox-list div { margin-bottom: 8px; display: flex; align-items: center; }
.checkbox-list input { margin-right: 8px; transform: scale(1.2); cursor: pointer; }
.checkbox-list label { margin-bottom: 0; cursor: pointer; }

/* 按鈕 */
button { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; transition: background 0.3s; }
#btn-generate { background-color: #2196F3; color: white; width: 100%; font-weight: bold; font-size: 1.1em; }
#btn-generate:disabled { background-color: #ccc; cursor: not-allowed; }
.btn-print { background-color: #FF9800; color: white; width: 100%; font-weight: bold; }
.btn-print:hover { background-color: #F57C00; }
.btn-secondary { background-color: #5c6bc0; color: white; font-size: 14px; }
.btn-small { padding: 5px 10px; border-radius: 4px; font-size: 13px; margin-right: 5px; cursor: pointer; border: 1px solid #ccc; background: white; }
.btn-green { background: #4CAF50; color: white; border: none; }
.btn-red { background: #f44336; color: white; border: none; }
.template-section { background: #e3f2fd; padding: 10px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #bbdefb; }

/* 分析儀表板 */
#analysis-dashboard { margin-top: 20px; padding-top: 20px; border-top: 2px dashed #ddd; }
.analysis-bar-row { display: flex; align-items: center; margin-bottom: 8px; font-size: 14px; }
.analysis-label { width: 60px; font-weight: bold; text-align: right; margin-right: 10px; }
.analysis-bar-container { flex: 1; background: #eee; height: 20px; border-radius: 4px; overflow: hidden; }
.analysis-bar { height: 100%; background: #ff7043; text-align: right; color: white; padding-right: 5px; line-height: 20px; font-size: 12px; transition: width 0.5s; }

/* 彈出視窗 (Modal) - 維持之前的樣式 */
.modal { display: none; position: fixed; z-index: 1000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); align-items: center; justify-content: center; }
.modal-content { background-color: #fefefe; width: 90%; max-width: 1000px; height: 80vh; display: flex; flex-direction: column; border-radius: 8px; }
.modal-header { padding: 15px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; background: #f5f5f5; border-radius: 8px 8px 0 0; }
.close-modal { font-size: 28px; cursor: pointer; }
.modal-body { display: flex; flex: 1; overflow: hidden; }
.settings-pane { flex: 1; padding: 20px; overflow-y: auto; border-right: 1px solid #eee; min-width: 300px; }
.preview-pane { flex: 2; padding: 20px; background: #fafafa; display: flex; flex-direction: column; overflow: hidden; }
.preview-box { background: white; border: 1px solid #ddd; padding: 20px; overflow-y: auto; flex: 1; }
.modal-footer { padding: 15px; text-align: right; background: #f5f5f5; border-radius: 0 0 8px 8px; }
.col-setting-row { display: flex; gap: 5px; margin-bottom: 8px; align-items: center; background: #f9f9f9; padding: 8px; border-radius: 4px; }
.col-setting-row input { width: 60px; }

/* 表格樣式 */
#output-area { background: white; max-width: 210mm; margin: 0 auto; min-height: 297mm; padding: 20mm; box-sizing: border-box; }
.student-section { margin-bottom: 50px; }
/* 強制分頁 Class */
.page-break-active { page-break-after: always; }
/* 無分頁時的虛線分隔 */
.page-break-none { border-bottom: 2px dashed #999; padding-bottom: 30px; margin-bottom: 30px; }

table { width: 100%; border-collapse: collapse; font-size: 14px; table-layout: fixed; }
th, td { border: 1px solid #333; padding: 10px; vertical-align: top; word-wrap: break-word; }
th { background-color: #f0f0f0; text-align: center; font-weight: bold; }
td img { max-width: 100%; height: auto; display: block; margin: 5px 0; }

/* 新增：步驟式佈局 */
.step-section {
    background: white; border: 1px solid #e0e0e0; border-radius: 8px;
    padding: 20px; margin-bottom: 20px; position: relative;
}
.step-header { display: flex; align-items: center; margin-bottom: 15px; }
.step-number {
    background: #2196F3; color: white; width: 30px; height: 30px;
    border-radius: 50%; text-align: center; line-height: 30px;
    font-weight: bold; margin-right: 10px;
}
.step-header h3 { margin: 0; color: #333; }

/* 標籤 */
.tag-new {
    background: #ff9800; color: white; font-size: 0.7em; padding: 2px 6px;
    border-radius: 4px; margin-left: 5px; vertical-align: middle;
}
.or-divider {
    display: flex; align-items: center; justify-content: center;
    color: #999; font-weight: bold; padding: 0 10px;
}

/* 按鈕與狀態 */
.btn-magic {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white; border: none; width: 100%; padding: 12px;
    font-weight: bold; margin-top: 5px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}
.btn-magic:hover { opacity: 0.9; transform: translateY(-1px); }

.status-text { display: block; margin-top: 5px; font-size: 0.85em; color: #f44336; }
.status-text.ok { color: #4CAF50; }

/* Mode Tabs */
.mode-tabs { display: flex; border-bottom: 1px solid #ddd; margin-bottom: 15px; }
.mode-tab {
    padding: 10px 20px; background: none; border: none; cursor: pointer;
    border-bottom: 3px solid transparent; color: #666; font-size: 15px;
}
.mode-tab.active {
    border-bottom-color: #2196F3; color: #2196F3; font-weight: bold;
}

/* Modal 內預覽區 */
.parsed-item {
    background: white; border: 1px solid #eee; padding: 8px;
    margin-bottom: 5px; border-radius: 4px; font-size: 0.9em;
}
.parsed-id { color: #2196F3; font-weight: bold; margin-right: 5px; }
.parsed-meta { color: #666; font-size: 0.85em; display: block; margin-top: 2px; }

/* Textarea 優化 */
textarea {
    border: 1px solid #ccc; border-radius: 4px; resize: none;
    line-height: 1.5;
}
textarea:focus { outline: 2px solid #2196F3; border-color: transparent; }

/* 列印專用 */
@media print {
    body { background: white; padding: 0; }
    .control-panel, .modal { display: none !important; }
    #output-area { width: 100%; max-width: none; padding: 0; margin: 0; box-shadow: none; }
    .student-section { margin: 0; padding: 10mm 15mm; height: auto; border: none; }
    /* 最後一頁不需要分頁 */
    .student-section:last-child { page-break-after: auto; }
}